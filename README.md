# SearchOpenExe

Windows 11 のエクスプローラー右クリックメニューから、指定フォルダ内で実行中のプロセスや、ファイルをロックしているプロセスを検索・表示・終了できるツールです。

## 機能

- **EXE 検索**: 対象フォルダ内の実行ファイル (.exe) から起動しているプロセスを検出
- **DLL モジュール検索**: 対象フォルダ内の DLL をロードしているプロセスを検出
- **ファイルロック検索**: Restart Manager API を使用して、ファイルをロックしているプロセスを検出
- **プロセス終了**: 検出したプロセスを選択して終了（確認ダイアログあり）
- **GUI 表示**: WinForms による一覧表示（プロセス名、PID、パス、検出種別、ロックファイル）

## インストール

### 方法 1: PowerShell スクリプト（推奨）

```powershell
# 右クリック → PowerShell で実行、または PowerShell から実行
.\Install.ps1
```

スクリプトの場所を自動検出し、コンテキストメニューを登録します。

### 方法 2: レジストリファイル（手動）

1. `install.reg` をテキストエディタで開く
2. `D:\\github\\SearchOpenExe\\SearchOpenExe.ps1` を実際のパスに書き換える（`\\` で区切る）
3. `install.reg` をダブルクリックして実行

## アンインストール

```powershell
.\Uninstall.ps1
```

または `uninstall.reg` をダブルクリックして実行。

## 使用方法

1. エクスプローラーでフォルダまたはファイルを右クリック
2. **「その他のオプションを確認」**（Windows 11）をクリック
3. **「Search Open Processes」**（フォルダ）または **「Search Locking Processes」**（ファイル）を選択
4. GUI ウィンドウが表示され、検出されたプロセスが一覧表示される
5. プロセスを選択して **「Terminate Selected」** で終了（確認ダイアログあり）

## ファイル構成

| ファイル | 説明 |
|---|---|
| `SearchOpenExe.ps1` | メインスクリプト（プロセス検索 + GUI） |
| `Install.ps1` | 自動パス検出のレジストリ登録スクリプト |
| `Uninstall.ps1` | レジストリ削除スクリプト |
| `install.reg` | 手動レジストリ登録用（パス編集要） |
| `uninstall.reg` | 手動レジストリ削除用 |

## 動作要件

- Windows 10 / 11
- PowerShell 5.1 以上（Windows 標準搭載）
- .NET Framework（WinForms 用、Windows 標準搭載）

## 制限事項

- **Windows 11 クラシックメニュー**: 右クリックメニューは「その他のオプションを確認」内に表示されます。Windows 11 の新しいコンテキストメニューに直接表示するには別途対応が必要です。
- **管理者権限**: 基本機能は一般ユーザーで動作しますが、管理者権限で実行するとシステムプロセスの DLL 検索やプロセス終了の対象が広がります。
- **ファイル数上限**: フォルダ内ファイルのロック検索は再帰探索で最大 500 ファイルまでです。
- **32/64-bit 制限**: 32-bit プロセスから 64-bit プロセスのモジュール一覧にはアクセスできない場合があります（逆も同様）。

## ライセンス

MIT License
